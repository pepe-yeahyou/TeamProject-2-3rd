/* ------------------------------------- */
/* 1. 레이아웃 및 기본 스타일 (다크 모드) */
/* ------------------------------------- */

html, body {
    margin: 0;
    padding: 0;
    background-color: #1a1a2e;
    overflow-x: hidden;
    /* 스크롤 문제 해결을 위해 추가 */
    overflow-y: hidden;
    height: 100%;
}

.detail-page {
    display: flex;
    gap: 30px; /* 25px → 30px (간격 증가) */
    padding: 40px 15%; /* 10% → 15% (좌우 여백 더 증가) */
    background-color: var(--color-bg-base);
    min-height: 100vh;
    color: var(--color-text-main);
    /* 스크롤 문제 해결을 위해 추가 */
    height: 100vh;
    overflow: hidden;
    box-sizing: border-box;
}

/* 주요 컨텐츠 영역 (좌측) - 높이 고정 및 아래쪽 맞춤 */
.main-content {
    flex: 2.3;
    display: flex;
    flex-direction: column;
    gap: 25px;
    overflow-y: auto;
    max-height: calc(100vh - 80px);
    padding-right: 8px; /* 5px → 8px (스크롤바 공간 증가) */
    /* 작업목록과 채팅 아래쪽 맞추기 위해 추가 */
    height: calc(100vh - 80px);
    overflow: hidden;
}

/* 사이드바 영역 (우측) - 높이 고정 및 아래쪽 맞춤 */
.sidebar {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 20px;
    overflow-y: auto;
    max-height: calc(100vh - 80px);
    padding-right: 8px; /* 5px → 8px (스크롤바 공간 증가) */
    /* 작업목록과 채팅 아래쪽 맞추기 위해 추가 */
    height: calc(100vh - 80px);
    overflow: hidden;
}

/* 모든 카드/섹션에 적용되는 기본 스타일 */
.detail-card {
    background-color: var(--color-bg-card);
    border: 1px solid var(--color-border);
    border-radius: 16px;
    padding: 24px; /* 25px → 24px (미묘한 조정) */
    /* 개선 1: 미묘한 그림자 레이어 */
    box-shadow:
            0 4px 12px rgba(0, 0, 0, 0.15),
            0 8px 24px rgba(0, 0, 0, 0.2);
    /* transform transition 제거 */
}

/* 메인컨텐츠 내부 카드 배치 - 아래쪽 맞춤용 */
.main-content > .detail-card {
    margin-bottom: 20px;
}

/* 메인컨텐츠의 마지막 카드(작업목록)가 남은 공간 차지 */
.main-content > .detail-card:last-child {
    flex: 1;
    display: flex;
    flex-direction: column;
    min-height: 0;
    margin-bottom: 0;
}

/* 사이드바 내부 카드 배치 - 아래쪽 맞춤용 */
.sidebar > .detail-card {
    margin-bottom: 20px;
}

/* 사이드바의 마지막 카드(채팅)가 남은 공간 차지 */
.sidebar > .detail-card:last-child {
    flex: 1;
    display: flex;
    flex-direction: column;
    min-height: 0;
    margin-bottom: 0;
}

/* 개선 2: 타이포그래피 가독성 향상 */
h2 {
    color: #ffffff;
    margin-top: 0;
    font-size: 1.85rem; /* 1.8 → 1.85 */
    font-weight: 700;
    display: flex;
    align-items: center;
    gap: 15px;
    line-height: 1.3;
    margin-bottom: 10px;
}

/* 제목 아래 미묘한 구분선 */
h2::after {
    content: '';
    display: block;
    width: 60px;
    height: 3px;
    background: var(--color-primary);
    margin-top: 12px;
    border-radius: 2px;
}

h3 {
    color: #e2e8f0; /* #90a0ff → #e2e8f0 (더 부드러운) */
    border-bottom: 2px solid #4a4a75;
    padding-bottom: 8px;
    margin-top: 0;
    font-size: 1.4rem;
    font-weight: 600; /* 굵기 추가 */
}

h4 {
    color: #90a0ff;
    border-bottom: 2px solid #4a4a75;
    padding-bottom: 8px;
    margin-top: 0;
    font-size: 1.4rem;
    text-align: center;
}

.action-buttons {
    display: flex;
    gap: 12px;
    align-items: center;
}

.title-section .action-buttons {
    margin-top: 10px;
}

/* ------------------------------------- */
/* 2. 상태 및 버튼 스타일 */
/* ------------------------------------- */
.status-진행중, .status-완료{
    padding: 5px 12px;
    border-radius: 8px;
    font-weight: bold;
    font-size: 0.9rem;
    letter-spacing: 0.5px;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
}

.status-진행중 {
    background-color: rgba(106, 90, 205, 0.9); /* 약간 투명하게 */
    color: #ffffff;
}

.status-완료 {
    background-color: rgba(72, 169, 166, 0.9); /* 약간 투명하게 */
    color: #ffffff;
}

.status-기간만료 {
    padding: 5px 12px;
    border-radius: 8px;
    font-weight: bold;
    font-size: 0.9rem;
    letter-spacing: 0.5px;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
    background-color: rgba(255, 77, 77, 0.9); /* 약간 투명하게 */
    color: #ffffff;
    box-shadow: 0 0 8px rgba(255, 77, 77, 0.4);
}

.detail-card.completion-message h4 {
    color: #ff4d4d;
    border-bottom: 2px solid #5a3c3c;
}

.action-buttons button {
    background-color: #8c7ae6;
    color: white;
    border: none;
    padding: 8px 15px;
    border-radius: 8px;
    cursor: pointer;
    transition: background-color 0.3s;
    font-weight: 600;
}

.action-buttons button:hover {
    background-color: #7d65cc;
}

.icon-btn {
    background-color: rgba(45, 45, 68, 0.8) !important; /* 약간 투명하게 */
    border: 1px solid #4a4a75 !important;
    color: #90a0ff !important;
    width: 46px; /* 48px → 46px */
    height: 46px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 10px; /* 12px → 10px */
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    cursor: pointer;
    padding: 0;
}

.icon-btn svg {
    display: block;
}

/* 아이콘 버튼 호버 효과 (움직임 없이 색상만) */
.icon-btn:hover {
    background-color: rgba(59, 59, 92, 0.9) !important;
    color: #ffffff !important;
    box-shadow: 0 0 12px rgba(144, 160, 255, 0.2); /* 15px → 12px */
}

.icon-btn.delete:hover {
    background-color: rgba(239, 68, 68, 0.9) !important; /* 투명도 추가 */
    border-color: rgba(239, 68, 68, 0.7) !important;
    color: white !important;
    box-shadow: 0 0 12px rgba(239, 68, 68, 0.3); /* 15px → 12px */
}

/* ------------------------------------- */
/* 3. 진척도 섹션 */
/* ------------------------------------- */
.progress-section {
    padding-bottom: 20px;
}

.progress-bar-container {
    background-color: rgba(30, 41, 59, 0.7); /* 약간 투명하게 */
    border-radius: 10px; /* 20px → 10px */
    height: 10px; /* 12px → 10px */
    overflow: hidden;
    margin-top: 15px;
}

.progress-bar {
    height: 100%;
    background: linear-gradient(90deg, var(--color-primary), #6a5acd); /* 색상 조화 */
    transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    border-radius: 10px;
    box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.2); /* 내부 그림자 */
}

.progress-info {
    display: flex;
    justify-content: space-between;
    font-weight: bold;
    font-size: 0.95rem;
    margin-top: 10px;
}

.status-진행중, .status-완료, .status-기간만료 {
    padding: 6px 14px;
    border-radius: 20px;
    font-size: 0.85rem;
    font-weight: 600;
}

.status-진행중 { background: var(--status-ongoing-bg); color: var(--status-ongoing-text); }
.status-완료 { background: var(--status-done-bg); color: var(--status-done-text); }
.status-기간만료 { background: var(--status-expired-bg); color: var(--status-expired-text); }

@keyframes pulse-soft {
    0% { opacity: 1; }
    50% { opacity: 0.8; }
    100% { opacity: 1; }
}

.status-진행중 {
    animation: pulse-soft 2s infinite ease-in-out;
}

/* ------------------------------------- */
/* 4. 작업 목록 (Todo list) - 아래쪽 맞춤용 수정 */
/* ------------------------------------- */
.task-list {
    flex: 1;
    display: flex;
    flex-direction: column;
    min-height: 0;
}

.task-list > h3 {
    flex-shrink: 0; /* 제목은 크기 고정 */
    margin-bottom: 15px;
}

.task-list ul {
    list-style: none;
    padding: 0;
    margin: 0;
    flex: 1; /* 남은 공간 모두 차지 */
    overflow-y: auto; /* 내용 많으면 스크롤 */
    min-height: 0;
}

.task-list li {
    display: flex;
    align-items: center;
    padding: 13px 0; /* 12px → 13px */
    border-bottom: 1px solid rgba(60, 60, 92, 0.8); /* 약간 밝게 */
}

.task-list li:last-child {
    border-bottom: none;
}

.round-button {
    width: 22px;
    height: 22px;
    border-radius: 50%;
    border: 2px solid #475569;
    background: transparent;
    cursor: pointer;
    margin-right: 12px;
    flex-shrink: 0;
    transition: all 0.2s;
}

.round-button.completed {
    background-color: var(--status-done-bg);
    border-color: var(--status-done-bg);
    color: white;
}

.round-button.in-progress:hover {
    background-color: #5a5a8a;
}

.task-list span {
    font-size: 1rem;
}

.task-list span[style*="line-through"] {
    color: #8888aa;
}

/* 작업 담당자 스타일 */
.task-assignee {
    font-size: 0.8rem;
    color: #8888aa;
    margin-top: 4px;
    font-style: italic;
}

/* ------------------------------------- */
/* 5. 팀 정보 (우측 상단) */
/* ------------------------------------- */
.team-info-section .info-item {
    margin-top: 12px;
    background-color: var(--color-bg-input);
    padding: 10px 15px;
    border-radius: 8px;
    margin-bottom: 12px;
    font-size: 1rem;
    border: 1px solid var(--color-border);
    border-left: 3px solid var(--color-primary);
    background: linear-gradient(90deg, rgba(144, 160, 255, 0.1) 0%, transparent 100%);
    transition: all 0.2s;
}

.team-info-section .info-item:hover {
    background: linear-gradient(90deg, rgba(144, 160, 255, 0.2) 0%, transparent 100%);
}

.team-info-section .info-item strong {
    display: block;
    font-size: 0.8rem;
    color: var(--color-primary);
    margin-bottom: 5px;
}

/* ------------------------------------- */
/* 6. 채팅 섹션 (우측 하단) - 아래쪽 맞춤용 수정 */
/* ------------------------------------- */
.chat-section {
    flex: 1;
    display: flex;
    flex-direction: column;
    min-height: 0;
    background-color: var(--color-bg-card);
    border-radius: 16px;
    overflow: hidden;
    border: 1px solid var(--color-border);
}

.chat-section > h3 {
    flex-shrink: 0; /* 제목은 크기 고정 */
    margin-bottom: 15px;
}

.chat-section-content {
    display: flex;
    flex-direction: column;
    flex: 1; /* 높이 자동 조정 */
    min-height: 0;
}

.chat-messages {
    flex: 1;
    overflow-y: auto;
    padding: 15px;
    border-top: 1px solid var(--color-border);
    background-color: rgba(15, 23, 42, 0.3);
    min-height: 0;
}

.chat-messages::-webkit-scrollbar {
    width: 5px;
}

.chat-messages::-webkit-scrollbar-track {
    background: transparent;
}

.chat-messages::-webkit-scrollbar-thumb {
    background: #4a4a75;
    border-radius: 10px;
}

.chat-messages::-webkit-scrollbar-thumb:hover {
    background: var(--color-primary);
}

.chat-message {
    display: flex;
    margin-bottom: 15px;
    align-items: flex-start;
}

.chat-message.me {
    justify-content: flex-end;
}

.chat-message.other {
    justify-content: flex-start;
}

.chat-bubble {
    display: inline-block !important;
    max-width: 85% !important;
    padding: 12px 18px;
    font-size: 0.95rem;
    line-height: 1.5;
    word-break: break-word !important;
    white-space: pre-wrap !important;
}

.chat-bubble.me {
    background: linear-gradient(135deg, var(--color-primary), #6366F1);
    border-radius: 16px 16px 4px 16px;
    box-shadow: 0 4px 12px var(--color-primary-glow);
}

.chat-bubble.other {
    background-color: #21262D;
    border: 1px solid var(--color-border);
    border-radius: 16px 16px 16px 4px;
}

.chat-message.me .chat-bubble {
    background: linear-gradient(135deg, var(--color-primary), #6366F1);
    color: white;
    border-radius: 20px 20px 4px 20px;
    box-shadow: 0 4px 15px var(--color-primary-glow);
}

.chat-message.other .chat-bubble {
    background-color: #21262D;
    color: var(--color-text-main);
    border: 1px solid var(--color-border);
    border-radius: 20px 20px 20px 4px;
}

.chat-sender {
    font-weight: bold;
    font-size: 0.9rem;
    margin-bottom: 2px;
}

.chat-time {
    font-size: 0.7rem;
    color: #aaaaaa;
    margin-top: 5px;
    display: block;
    text-align: right;
}

.chat-input-container {
    display: flex;
    gap: 10px;
    padding-top: 15px;
    flex-shrink: 0; /* 입력창 크기 고정 */
}

.chat-input-container input {
    flex-grow: 1;
    padding: 10px 15px;
    border-radius: 20px;
    border: 1px solid #5a5a8a;
    background-color: #3b3b5c;
    color: white;
    outline: none;
}

.chat-input-container button {
    background-color: #8c7ae6;
    color: white;
    border: none;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    transition: background-color 0.3s;
    font-size: 1rem;
}

.chat-input-container button:hover {
    background-color: #7d65cc;
}

.chat-connection-status {
    text-align: center;
    padding: 10px 0;
    font-size: 0.8rem;
    font-weight: bold;
    flex-shrink: 0; /* 연결 상태 크기 고정 */
}

.chat-connection-status .status-connected { color: #48a9a6; }
.chat-connection-status .status-connecting { color: #ff9f43; }

.chat-bubble-container { max-width: 85%; }

.chat-sender-info {
    font-size: 0.75rem;
    margin-bottom: 4px;
    color: #94a3b8;
}

.chat-message.other .chat-sender-info {
    text-align: left;
}

.chat-sender {
    font-weight: bold;
    color: #f0f0f0;
    margin-right: 8px;
}

.chat-time-inline {
    font-size: 0.75rem;
    color: #8888aa;
}

.chat-input {
    flex-grow: 1;
    background-color: #1e293b;
    border: 1px solid var(--color-border);
    border-radius: 20px;
    padding: 10px 16px;
    color: white;
    outline: none;
    transition: border-color 0.2s;
}

.chat-input:focus { border-color: var(--color-primary); }

.chat-send-button {
    background-color: var(--color-primary);
    color: white;
    border: none;
    width: 38px;
    height: 38px;
    border-radius: 50%;
    cursor: pointer;
    transition: transform 0.2s;
}

.chat-send-button:hover:not(:disabled) { transform: scale(1.1); }
.chat-send-button:disabled { opacity: 0.5; cursor: not-allowed; }

.chat-disabled-message {
    padding: 20px;
    text-align: center;
    border-radius: 8px;
    background-color: #3b3b5c;
    color: #aaaaaa;
    font-size: 0.9rem;
    margin-top: 20px;
}

/* ------------------------------------- */
/* 7. 스크롤바 스타일 추가 */
/* ------------------------------------- */
.main-content::-webkit-scrollbar,
.sidebar::-webkit-scrollbar,
.task-list ul::-webkit-scrollbar,
.chat-messages::-webkit-scrollbar {
    width: 4px; /* 6px → 4px */
}

.main-content::-webkit-scrollbar-track,
.sidebar::-webkit-scrollbar-track,
.task-list ul::-webkit-scrollbar-track,
.chat-messages::-webkit-scrollbar-track {
    background: transparent;
}

.main-content::-webkit-scrollbar-thumb,
.sidebar::-webkit-scrollbar-thumb,
.task-list ul::-webkit-scrollbar-thumb,
.chat-messages::-webkit-scrollbar-thumb {
    background: rgba(144, 160, 255, 0.3); /* 반투명하게 */
    border-radius: 2px;
}

.main-content::-webkit-scrollbar-thumb:hover,
.sidebar::-webkit-scrollbar-thumb:hover,
.task-list ul::-webkit-scrollbar-thumb:hover,
.chat-messages::-webkit-scrollbar-thumb:hover {
    background: rgba(144, 160, 255, 0.5);
}

/* ------------------------------------- */
/* 8. 반응형 디자인 */
/* ------------------------------------- */
@media (max-width: 1200px) {
    .detail-page {
        flex-direction: column;
        height: auto;
        min-height: 100vh;
        overflow-y: auto;
        padding: 30px 10%; /* 8% → 10% (반응형에서도 여백 증가) */
    }

    .main-content, .sidebar {
        height: auto;
        max-height: none;
        overflow: visible;
        padding-right: 0;
    }

    .main-content > .detail-card:last-child,
    .sidebar > .detail-card:last-child {
        flex: none;
    }

    .task-list, .chat-section {
        min-height: 400px;
    }
}

@media (max-width: 768px) {
    .detail-page {
        padding: 20px 8%; /* 모바일에서도 여백 증가 */
        gap: 20px;
    }

    .detail-card {
        padding: 20px;
    }

    h2 {
        font-size: 1.7rem; /* 1.6 → 1.7 */
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
    }

    .action-buttons {
        width: 100%;
        justify-content: flex-start;
    }

    .icon-btn {
        width: 44px;
        height: 44px;
    }

    .task-list, .chat-section {
        min-height: 300px;
    }
}